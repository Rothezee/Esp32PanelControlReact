import{j as e,u as me,a as Z,b as xe,m as C,L as _,A as $,c as Ke,d as Ze,e as Xe,R as et,f as q,N as pe,Q as tt,g as st,h as at,i as rt}from"./vendor-B3f-z7mW.js";import{c as nt,r as N,g as it,R as Me}from"./react-BEcWu9pM.js";import{c as H,g as le,s as re,a as lt,o as Ee,b as ot,d as ct,e as dt,f as U,h as mt,u as xt,i as ut,j as ht,k as yt,l as Te,m as gt,n as pt,p as ft,q as bt,r as jt,t as vt,v as Nt,w as oe,x as fe,y as kt,z as wt,A as St,B as Dt,C as Ct,D as Mt,E as Et,F as Tt,G as Pt,H as It,I as At,J as zt,K as Lt,L as Ft,M as Ot,N as Pe,O as $t,P as qt,Q as _t,R as Rt,S as Ht,T as Vt,U as I,V as Bt,W as Wt,X as Ut,Y as Gt,Z as Jt,_ as Yt,$ as Qt}from"./utils-CLoW5-XR.js";import{b as Kt,C as Zt,c as Xt,L as es,P as ts,d as ss,B as as,A as rs,i as ns,p as is,e as ls,f as os,T as cs,g as ds,h as ms,D as xs}from"./charts-AhwQhWVl.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const n of i)if(n.type==="childList")for(const l of n.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function a(i){const n={};return i.integrity&&(n.integrity=i.integrity),i.referrerPolicy&&(n.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?n.credentials="include":i.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function r(i){if(i.ep)return;i.ep=!0;const n=a(i);fetch(i.href,n)}})();var ce={},be=nt;ce.createRoot=be.createRoot,ce.hydrateRoot=be.hydrateRoot;const us={},je=t=>{let s;const a=new Set,r=(u,g)=>{const f=typeof u=="function"?u(s):u;if(!Object.is(f,s)){const h=s;s=g??(typeof f!="object"||f===null)?f:Object.assign({},s,f),a.forEach(m=>m(s,h))}},i=()=>s,b={setState:r,getState:i,getInitialState:()=>o,subscribe:u=>(a.add(u),()=>a.delete(u)),destroy:()=>{(us?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),a.clear()}},o=s=t(r,i,b);return b},hs=t=>t?je(t):je;var Ie={exports:{}},Ae={},ze={exports:{}},Le={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var V=N;function ys(t,s){return t===s&&(t!==0||1/t===1/s)||t!==t&&s!==s}var gs=typeof Object.is=="function"?Object.is:ys,ps=V.useState,fs=V.useEffect,bs=V.useLayoutEffect,js=V.useDebugValue;function vs(t,s){var a=s(),r=ps({inst:{value:a,getSnapshot:s}}),i=r[0].inst,n=r[1];return bs(function(){i.value=a,i.getSnapshot=s,ne(i)&&n({inst:i})},[t,a,s]),fs(function(){return ne(i)&&n({inst:i}),t(function(){ne(i)&&n({inst:i})})},[t]),js(a),a}function ne(t){var s=t.getSnapshot;t=t.value;try{var a=s();return!gs(t,a)}catch{return!0}}function Ns(t,s){return s()}var ks=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?Ns:vs;Le.useSyncExternalStore=V.useSyncExternalStore!==void 0?V.useSyncExternalStore:ks;ze.exports=Le;var ws=ze.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var X=N,Ss=ws;function Ds(t,s){return t===s&&(t!==0||1/t===1/s)||t!==t&&s!==s}var Cs=typeof Object.is=="function"?Object.is:Ds,Ms=Ss.useSyncExternalStore,Es=X.useRef,Ts=X.useEffect,Ps=X.useMemo,Is=X.useDebugValue;Ae.useSyncExternalStoreWithSelector=function(t,s,a,r,i){var n=Es(null);if(n.current===null){var l={hasValue:!1,value:null};n.current=l}else l=n.current;n=Ps(function(){function b(h){if(!o){if(o=!0,u=h,h=r(h),i!==void 0&&l.hasValue){var m=l.value;if(i(m,h))return g=m}return g=h}if(m=g,Cs(u,h))return m;var x=r(h);return i!==void 0&&i(m,x)?(u=h,m):(u=h,g=x)}var o=!1,u,g,f=a===void 0?null:a;return[function(){return b(s())},f===null?void 0:function(){return b(f())}]},[s,a,r,i]);var y=Ms(t,n[0],n[1]);return Ts(function(){l.hasValue=!0,l.value=y},[y]),Is(y),y};Ie.exports=Ae;var As=Ie.exports;const zs=it(As),Fe={},{useDebugValue:Ls}=Me,{useSyncExternalStoreWithSelector:Fs}=zs;let ve=!1;const Os=t=>t;function $s(t,s=Os,a){(Fe?"production":void 0)!=="production"&&a&&!ve&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),ve=!0);const r=Fs(t.subscribe,t.getState,t.getServerState||t.getInitialState,s,a);return Ls(r),r}const qs=t=>{(Fe?"production":void 0)!=="production"&&typeof t!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const s=typeof t=="function"?hs(t):t,a=(r,i)=>$s(s,r,i);return Object.assign(a,s),a},Oe=t=>qs,_s={};function Rs(t,s){let a;try{a=t()}catch{return}return{getItem:i=>{var n;const l=b=>b===null?null:JSON.parse(b,void 0),y=(n=a.getItem(i))!=null?n:null;return y instanceof Promise?y.then(l):l(y)},setItem:(i,n)=>a.setItem(i,JSON.stringify(n,void 0)),removeItem:i=>a.removeItem(i)}}const J=t=>s=>{try{const a=t(s);return a instanceof Promise?a:{then(r){return J(r)(a)},catch(r){return this}}}catch(a){return{then(r){return this},catch(r){return J(r)(a)}}}},Hs=(t,s)=>(a,r,i)=>{let n={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:v=>v,version:0,merge:(v,p)=>({...p,...v}),...s},l=!1;const y=new Set,b=new Set;let o;try{o=n.getStorage()}catch{}if(!o)return t((...v)=>{console.warn(`[zustand persist middleware] Unable to update item '${n.name}', the given storage is currently unavailable.`),a(...v)},r,i);const u=J(n.serialize),g=()=>{const v=n.partialize({...r()});let p;const j=u({state:v,version:n.version}).then(S=>o.setItem(n.name,S)).catch(S=>{p=S});if(p)throw p;return j},f=i.setState;i.setState=(v,p)=>{f(v,p),g()};const h=t((...v)=>{a(...v),g()},r,i);let m;const x=()=>{var v;if(!o)return;l=!1,y.forEach(j=>j(r()));const p=((v=n.onRehydrateStorage)==null?void 0:v.call(n,r()))||void 0;return J(o.getItem.bind(o))(n.name).then(j=>{if(j)return n.deserialize(j)}).then(j=>{if(j)if(typeof j.version=="number"&&j.version!==n.version){if(n.migrate)return n.migrate(j.state,j.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return j.state}).then(j=>{var S;return m=n.merge(j,(S=r())!=null?S:h),a(m,!0),g()}).then(()=>{p==null||p(m,void 0),l=!0,b.forEach(j=>j(m))}).catch(j=>{p==null||p(void 0,j)})};return i.persist={setOptions:v=>{n={...n,...v},v.getStorage&&(o=v.getStorage())},clearStorage:()=>{o==null||o.removeItem(n.name)},getOptions:()=>n,rehydrate:()=>x(),hasHydrated:()=>l,onHydrate:v=>(y.add(v),()=>{y.delete(v)}),onFinishHydration:v=>(b.add(v),()=>{b.delete(v)})},x(),m||h},Vs=(t,s)=>(a,r,i)=>{let n={storage:Rs(()=>localStorage),partialize:x=>x,version:0,merge:(x,v)=>({...v,...x}),...s},l=!1;const y=new Set,b=new Set;let o=n.storage;if(!o)return t((...x)=>{console.warn(`[zustand persist middleware] Unable to update item '${n.name}', the given storage is currently unavailable.`),a(...x)},r,i);const u=()=>{const x=n.partialize({...r()});return o.setItem(n.name,{state:x,version:n.version})},g=i.setState;i.setState=(x,v)=>{g(x,v),u()};const f=t((...x)=>{a(...x),u()},r,i);i.getInitialState=()=>f;let h;const m=()=>{var x,v;if(!o)return;l=!1,y.forEach(j=>{var S;return j((S=r())!=null?S:f)});const p=((v=n.onRehydrateStorage)==null?void 0:v.call(n,(x=r())!=null?x:f))||void 0;return J(o.getItem.bind(o))(n.name).then(j=>{if(j)if(typeof j.version=="number"&&j.version!==n.version){if(n.migrate)return[!0,n.migrate(j.state,j.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,j.state];return[!1,void 0]}).then(j=>{var S;const[d,w]=j;if(h=n.merge(w,(S=r())!=null?S:f),a(h,!0),d)return u()}).then(()=>{p==null||p(h,void 0),h=r(),l=!0,b.forEach(j=>j(h))}).catch(j=>{p==null||p(void 0,j)})};return i.persist={setOptions:x=>{n={...n,...x},x.storage&&(o=x.storage)},clearStorage:()=>{o==null||o.removeItem(n.name)},getOptions:()=>n,rehydrate:()=>m(),hasHydrated:()=>l,onHydrate:x=>(y.add(x),()=>{y.delete(x)}),onFinishHydration:x=>(b.add(x),()=>{b.delete(x)})},n.skipHydration||m(),h||f},Bs=(t,s)=>"getStorage"in s||"serialize"in s||"deserialize"in s?((_s?"production":void 0)!=="production"&&console.warn("[DEPRECATED] `getStorage`, `serialize` and `deserialize` options are deprecated. Use `storage` option instead."),Hs(t,s)):Vs(t,s),$e=Bs,ue=Oe()($e(t=>({user:null,token:null,isAuthenticated:!1,login:async(s,a)=>{try{const r=await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:s,password:a})});if(!r.ok)throw new Error("Invalid credentials");const i=await r.json();t({user:i.user,token:i.token,isAuthenticated:!0})}catch(r){throw r}},logout:()=>{t({user:null,token:null,isAuthenticated:!1})}}),{name:"auth-storage"}));/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Ws={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Us=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),k=(t,s)=>{const a=N.forwardRef(({color:r="currentColor",size:i=24,strokeWidth:n=2,absoluteStrokeWidth:l,className:y="",children:b,...o},u)=>N.createElement("svg",{ref:u,...Ws,width:i,height:i,stroke:r,strokeWidth:l?Number(n)*24/Number(i):n,className:["lucide",`lucide-${Us(t)}`,y].join(" "),...o},[...s.map(([g,f])=>N.createElement(g,f)),...Array.isArray(b)?b:[b]]));return a.displayName=`${t}`,a};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B=k("Activity",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const de=k("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ne=k("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gs=k("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const he=k("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ye=k("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q=k("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qe=k("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _e=k("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Js=k("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ys=k("Coins",[["circle",{cx:"8",cy:"8",r:"6",key:"3yglwk"}],["path",{d:"M18.09 10.37A6 6 0 1 1 10.34 18",key:"t5s6rm"}],["path",{d:"M7 6h1v4",key:"1obek4"}],["path",{d:"m16.71 13.88.7.71-2.82 2.82",key:"1rbuyh"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y=k("Cpu",[["rect",{x:"4",y:"4",width:"16",height:"16",rx:"2",key:"1vbyd7"}],["rect",{x:"9",y:"9",width:"6",height:"6",key:"o3kz5p"}],["path",{d:"M15 2v2",key:"13l42r"}],["path",{d:"M15 20v2",key:"15mkzm"}],["path",{d:"M2 15h2",key:"1gxd5l"}],["path",{d:"M2 9h2",key:"1bbxkp"}],["path",{d:"M20 15h2",key:"19e6y8"}],["path",{d:"M20 9h2",key:"19tzq7"}],["path",{d:"M9 2v2",key:"165o2o"}],["path",{d:"M9 20v2",key:"i2bqo8"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qs=k("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Re=k("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const He=k("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ke=k("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ks=k("Gauge",[["path",{d:"m12 14 4-4",key:"9kzdfg"}],["path",{d:"M3.34 19a10 10 0 1 1 17.32 0",key:"19p75a"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zs=k("Grid3x3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xs=k("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ea=k("List",[["line",{x1:"8",x2:"21",y1:"6",y2:"6",key:"7ey8pc"}],["line",{x1:"8",x2:"21",y1:"12",y2:"12",key:"rjfblc"}],["line",{x1:"8",x2:"21",y1:"18",y2:"18",key:"c3b1m8"}],["line",{x1:"3",x2:"3.01",y1:"6",y2:"6",key:"1g7gq3"}],["line",{x1:"3",x2:"3.01",y1:"12",y2:"12",key:"1pjlvk"}],["line",{x1:"3",x2:"3.01",y1:"18",y2:"18",key:"28t2mc"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ta=k("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sa=k("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aa=k("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ra=k("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const na=k("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ia=k("MoreVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const la=k("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G=k("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ve=k("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const we=k("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oa=k("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Be=k("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ca=k("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const da=k("Ticket",[["path",{d:"M2 9a3 3 0 0 1 0 6v2a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-2a3 3 0 0 1 0-6V7a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2Z",key:"qn84l0"}],["path",{d:"M13 5v2",key:"dyzc3o"}],["path",{d:"M13 17v2",key:"1ont0d"}],["path",{d:"M13 11v2",key:"1wjjxi"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const We=k("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ue=k("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K=k("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ma=k("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ge=k("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ee=k("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]);function xa(){const[t,s]=N.useState(""),[a,r]=N.useState(""),[i,n]=N.useState(""),[l,y]=N.useState(!1),{login:b}=ue(),o=async u=>{u.preventDefault(),n(""),y(!0);try{await b(t,a)}catch{n("Usuario o contraseña incorrectos")}finally{y(!1)}};return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"max-w-md w-full space-y-8",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"mt-6 text-center text-3xl font-extrabold text-gray-900",children:"ESP32 Monitoring System"}),e.jsx("p",{className:"mt-2 text-center text-sm text-gray-600",children:"Ingresa tus credenciales para acceder"})]}),e.jsxs("form",{className:"mt-8 space-y-6",onSubmit:o,children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"username",className:"sr-only",children:"Usuario"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(ma,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{id:"username",name:"username",type:"text",required:!0,className:"input pl-10",placeholder:"Usuario",value:t,onChange:u=>s(u.target.value)})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",className:"sr-only",children:"Contraseña"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(sa,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{id:"password",name:"password",type:"password",required:!0,className:"input pl-10",placeholder:"Contraseña",value:a,onChange:u=>r(u.target.value)})]})]})]}),i&&e.jsx("div",{className:"text-red-600 text-sm text-center",children:i}),e.jsx("div",{children:e.jsx("button",{type:"submit",disabled:l,className:"btn btn-primary w-full py-3 px-4 text-base",children:l?"Ingresando...":"Ingresar"})})]})]})})}function te(){return me({queryKey:["devices"],queryFn:async()=>{const t=await fetch("/api/devices");if(!t.ok)throw new Error("Failed to fetch devices");return t.json()},refetchInterval:3e4})}function ua(){const t=Z();return xe({mutationFn:async s=>{const a=await fetch("/api/devices",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});if(!a.ok)throw new Error("Failed to create device");return a.json()},onSuccess:()=>{t.invalidateQueries({queryKey:["devices"]})}})}function ha(){const t=Z();return xe({mutationFn:async({id:s,...a})=>{const r=await fetch(`/api/devices/${s}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(!r.ok)throw new Error("Failed to update device");return r.json()},onSuccess:()=>{t.invalidateQueries({queryKey:["devices"]})}})}function ya(){const t=Z();return xe({mutationFn:async s=>{const a=await fetch(`/api/devices/${s}`,{method:"DELETE"});if(!a.ok)throw new Error("Failed to delete device");return a.json()},onSuccess:()=>{t.invalidateQueries({queryKey:["devices"]})}})}function ga(){const t=N.useRef(null),s=Z(),a=N.useRef();return N.useEffect(()=>{const r=()=>{try{const n=`${window.location.protocol==="https:"?"wss:":"ws:"}//${window.location.host}/ws`;t.current=new WebSocket(n),t.current.onopen=()=>{console.log("WebSocket connected"),a.current&&clearTimeout(a.current)},t.current.onmessage=l=>{try{JSON.parse(l.data).type==="device_update"&&s.invalidateQueries({queryKey:["devices"]})}catch(y){console.error("Error parsing WebSocket message:",y)}},t.current.onclose=()=>{console.log("WebSocket disconnected"),a.current=setTimeout(()=>{(!t.current||t.current.readyState===WebSocket.CLOSED)&&r()},5e3)},t.current.onerror=l=>{console.error("WebSocket error:",l)}}catch(i){console.error("Failed to create WebSocket connection:",i),a.current=setTimeout(r,5e3)}};return r(),()=>{a.current&&clearTimeout(a.current),t.current&&t.current.close()}},[s]),t.current}function pa(t,s="7d"){return me({queryKey:["analytics",t,s],queryFn:async()=>{const a=new URLSearchParams({period:s});try{const r=await fetch(`/api/analytics?${a}`);if(!r.ok)throw new Error("Failed to fetch analytics");return r.json()}catch{return console.warn("Analytics API not available, using default data"),{metrics:[],chartData:{},trends:{}}}},refetchInterval:6e4,retry:1,staleTime:3e4})}function Ge({device:t,onEdit:s}){const[a,r]=N.useState(!1),i=ya(),n=g=>{switch(g){case"online":return"status-online";case"offline":return"status-offline";default:return"status-unknown"}},y=(g=>{switch(g){case"grua":return B;case"expendedora":return Ys;case"videojuego":return ee;case"ticketera":return da;default:return B}})(t.type),b=async()=>{if(window.confirm(`¿Estás seguro de que quieres eliminar ${t.name}?`))try{await i.mutateAsync(t.id)}catch(g){console.error("Error deleting device:",g)}},o=()=>t.fields.map(g=>{const f=t.data[g.key],h=g.key==="banco"&&f&&f<=-10;return e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-sm text-gray-600",children:[g.name,":"]}),e.jsx("span",{className:H("font-medium",h?"text-red-600 font-bold":""),children:f??"N/A"})]},g.id)}),u=t.fields.some(g=>t.data!==void 0&&g.key==="banco"&&t.data[g.key]!==void 0&&t.data&&t.data[g.key]!==void 0&&t.data[g.key]<=-10);return e.jsxs(C.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{duration:.2},className:H("card p-6 relative",u?"bg-red-50 border-red-200":"",t.status==="online"?"ring-2 ring-success-200":""),children:[e.jsx("div",{className:"absolute top-4 right-4",children:e.jsxs("div",{className:"relative",children:[e.jsx("button",{onClick:()=>r(!a),className:"p-1 rounded-md text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(ia,{className:"w-4 h-4"})}),a&&e.jsx("div",{className:"absolute right-0 mt-2 w-48 bg-white rounded-md shadow-lg border border-gray-200 z-10",children:e.jsxs("div",{className:"py-1",children:[e.jsxs(_,{to:`/reports/${t.id}`,className:"flex items-center px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",onClick:()=>r(!1),children:[e.jsx(He,{className:"w-4 h-4 mr-2"}),"Ver Reportes"]}),s&&e.jsxs("button",{onClick:()=>{s(t),r(!1)},className:"flex items-center w-full px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",children:[e.jsx(la,{className:"w-4 h-4 mr-2"}),"Editar"]}),e.jsxs("button",{onClick:()=>{b(),r(!1)},className:"flex items-center w-full px-4 py-2 text-sm text-red-600 hover:bg-red-50",children:[e.jsx(We,{className:"w-4 h-4 mr-2"}),"Eliminar"]})]})})]})}),e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:H("p-2 rounded-lg",t.status==="online"?"bg-success-100":"bg-gray-100"),children:e.jsx(y,{className:H("w-6 h-6",t.status==="online"?"text-success-600":"text-gray-600")})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:t.name}),e.jsx("p",{className:"text-sm text-gray-500 capitalize",children:t.type}),e.jsx("p",{className:"text-xs text-gray-400",children:t.locality})]})]})}),e.jsx("div",{className:"mb-4",children:e.jsxs("span",{className:H("inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium",n(t.status)),children:[e.jsx("span",{className:H("w-1.5 h-1.5 rounded-full mr-1.5",t.status==="online"?"bg-success-400":t.status==="offline"?"bg-danger-400":"bg-gray-400")}),t.status==="online"?"Conectado":t.status==="offline"?"Desconectado":"Desconocido"]})}),e.jsx("div",{className:"space-y-3 mb-6",children:o()}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(_,{to:`/reports/${t.id}`,className:"btn btn-primary flex-1 py-2 px-4 text-center",children:"Ver Reportes"}),e.jsx(_,{to:`/analytics?device=${t.id}`,className:"btn btn-secondary py-2 px-4",children:e.jsx(he,{className:"w-4 h-4"})})]}),e.jsx("div",{className:"mt-4 pt-4 border-t border-gray-100",children:e.jsxs("p",{className:"text-xs text-gray-500",children:["Última actualización: ",new Date(t.lastHeartbeat).toLocaleString()]})})]})}function fa(){const{data:t,isLoading:s,error:a}=te(),{data:r}=pa(),[i,n]=N.useState(""),[l,y]=N.useState("all"),[b,o]=N.useState("all");if(ga(),s)return e.jsxs("div",{className:"flex items-center justify-center h-64",children:[e.jsx("div",{className:"loading-spinner w-8 h-8"}),e.jsx("span",{className:"ml-3 text-gray-600",children:"Cargando dispositivos..."})]});if(a)return e.jsxs("div",{className:"flex items-center justify-center h-64",children:[e.jsx(de,{className:"w-8 h-8 text-red-600"}),e.jsx("span",{className:"ml-3 text-red-600",children:"Error al cargar los dispositivos"})]});const u=(t==null?void 0:t.filter(p=>{const j=p.name.toLowerCase().includes(i.toLowerCase()),S=l==="all"||p.type===l,d=b==="all"||p.status===b;return j&&S&&d}))||[],g={grua:u.filter(p=>p.type==="grua"),expendedora:u.filter(p=>p.type==="expendedora"),videojuego:u.filter(p=>p.type==="videojuego"),ticketera:u.filter(p=>p.type==="ticketera")},f=(t==null?void 0:t.length)||0,h=(t==null?void 0:t.filter(p=>p.status==="online").length)||0,m=(t==null?void 0:t.filter(p=>p.status==="offline").length)||0,x=[{title:"Total Dispositivos",value:f,icon:B,color:"from-blue-500 to-blue-600",change:0},{title:"En Línea",value:h,icon:K,color:"from-green-500 to-green-600",change:0},{title:"Desconectados",value:m,icon:Ue,color:"from-red-500 to-red-600",change:0},{title:"Eficiencia",value:f>0?Math.round(h/f*100):0,icon:ee,color:"from-purple-500 to-purple-600",change:0,suffix:"%"}],v=(p,j)=>j.length===0?null:e.jsxs(C.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"mb-8",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-6",children:p}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:j.map(S=>e.jsx(Ge,{device:S},S.id))})]});return e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Dashboard"}),e.jsx("p",{className:"mt-2 text-gray-600",children:"Monitoreo en tiempo real de todas las máquinas ESP32"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:x.map((p,j)=>{const S=p.icon;return e.jsx(C.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:j*.1},className:`metric-card bg-gradient-to-r ${p.color}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-white/80 text-sm font-medium",children:p.title}),e.jsxs("p",{className:"text-2xl font-bold text-white",children:[p.value,p.suffix||""]})]}),e.jsx(S,{className:"w-8 h-8 text-white/80"})]})},p.title)})}),e.jsx("div",{className:"card p-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx(oa,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),e.jsx("input",{type:"text",placeholder:"Buscar dispositivos...",value:i,onChange:p=>n(p.target.value),className:"input pl-10"})]})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("select",{value:l,onChange:p=>y(p.target.value),className:"input",children:[e.jsx("option",{value:"all",children:"Todos los tipos"}),e.jsx("option",{value:"grua",children:"Grúas"}),e.jsx("option",{value:"expendedora",children:"Expendedoras"}),e.jsx("option",{value:"videojuego",children:"Videojuegos"}),e.jsx("option",{value:"ticketera",children:"Ticketeras"})]}),e.jsxs("select",{value:b,onChange:p=>o(p.target.value),className:"input",children:[e.jsx("option",{value:"all",children:"Todos los estados"}),e.jsx("option",{value:"online",children:"En línea"}),e.jsx("option",{value:"offline",children:"Desconectado"}),e.jsx("option",{value:"unknown",children:"Desconocido"})]})]})]})}),v("Máquinas de Grúa",g.grua),v("Expendedoras",g.expendedora),v("Videojuegos",g.videojuego),v("Ticketeras",g.ticketera),u.length===0&&e.jsxs(C.div,{initial:{opacity:0},animate:{opacity:1},className:"text-center py-12",children:[e.jsx(de,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:(t==null?void 0:t.length)===0?"No hay dispositivos configurados":"No se encontraron dispositivos"}),e.jsx("p",{className:"text-gray-600",children:(t==null?void 0:t.length)===0?"Conecta tus dispositivos ESP32 para comenzar el monitoreo":"Intenta ajustar los filtros de búsqueda"})]})]})}const Se=(t,s,a)=>{if(t&&"reportValidity"in t){const r=le(a,s);t.setCustomValidity(r&&r.message||""),t.reportValidity()}},Je=(t,s)=>{for(const a in s.fields){const r=s.fields[a];r&&r.ref&&"reportValidity"in r.ref?Se(r.ref,a,t):r.refs&&r.refs.forEach(i=>Se(i,a,t))}},ba=(t,s)=>{s.shouldUseNativeValidation&&Je(t,s);const a={};for(const r in t){const i=le(s.fields,r),n=Object.assign(t[r]||{},{ref:i&&i.ref});if(ja(s.names||Object.keys(t),r)){const l=Object.assign({},le(a,r));re(l,"root",n),re(a,r,l)}else re(a,r,n)}return a},ja=(t,s)=>t.some(a=>a.startsWith(s+"."));var va=function(t,s){for(var a={};t.length;){var r=t[0],i=r.code,n=r.message,l=r.path.join(".");if(!a[l])if("unionErrors"in r){var y=r.unionErrors[0].errors[0];a[l]={message:y.message,type:y.code}}else a[l]={message:n,type:i};if("unionErrors"in r&&r.unionErrors.forEach(function(u){return u.errors.forEach(function(g){return t.push(g)})}),s){var b=a[l].types,o=b&&b[r.code];a[l]=lt(l,s,a,i,o?[].concat(o,r.message):r.message)}t.shift()}return a},Na=function(t,s,a){return a===void 0&&(a={}),function(r,i,n){try{return Promise.resolve(function(l,y){try{var b=Promise.resolve(t[a.mode==="sync"?"parse":"parseAsync"](r,s)).then(function(o){return n.shouldUseNativeValidation&&Je({},n),{errors:{},values:a.raw?r:o}})}catch(o){return y(o)}return b&&b.then?b.then(void 0,y):b}(0,function(l){if(function(y){return Array.isArray(y==null?void 0:y.errors)}(l))return{values:{},errors:ba(va(l.errors,!n.shouldUseNativeValidation&&n.criteriaMode==="all"),n)};throw l}))}catch(l){return Promise.reject(l)}}};const ka=Ee({name:U().min(1,"El nombre es requerido"),key:U().min(1,"La clave es requerida").regex(/^[a-zA-Z_][a-zA-Z0-9_]*$/,"Clave inválida"),type:dt(["number","text","boolean"]),required:ct(),defaultValue:ot().optional()}),wa=Ee({name:U().min(1,"El nombre es requerido"),type:U().min(1,"El tipo es requerido"),locality:U().optional(),fields:mt(ka).min(1,"Al menos un campo es requerido")});function Sa({device:t,onSubmit:s,onCancel:a,isLoading:r}){var S;const[i,n]=N.useState(!1),{register:l,control:y,handleSubmit:b,watch:o,formState:{errors:u}}=xt({resolver:Na(wa),defaultValues:{name:(t==null?void 0:t.name)||"",type:(t==null?void 0:t.type)??void 0,locality:(t==null?void 0:t.locality)||"",fields:(t==null?void 0:t.fields)||[{name:"Coin",key:"coin",type:"number",required:!0}]}}),{fields:g,append:f,remove:h}=ut({control:y,name:"fields"}),m=o(),x=[{value:"grua",label:"Máquina de Grúa"},{value:"expendedora",label:"Expendedora"},{value:"videojuego",label:"Videojuego"},{value:"ticketera",label:"Ticketera"},{value:"custom",label:"Personalizado"}],v=[{value:"number",label:"Número"},{value:"text",label:"Texto"},{value:"boolean",label:"Booleano"}],p=()=>{f({name:"",key:"",type:"number",required:!1})},j=d=>d.toLowerCase().replace(/[^a-z0-9]/g,"_").replace(/_+/g,"_").replace(/^_|_$/g,"");return e.jsx("div",{className:"max-w-4xl mx-auto",children:e.jsxs("div",{className:"card-elevated p-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:t?"Editar Dispositivo":"Crear Nuevo Dispositivo"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Configure los campos y propiedades del dispositivo"})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{type:"button",onClick:()=>n(!i),className:"btn btn-secondary",children:i?"Ocultar":"Vista Previa"}),e.jsx("button",{type:"button",onClick:a,className:"btn btn-ghost",children:e.jsx(ge,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[e.jsx("div",{children:e.jsxs("form",{onSubmit:b(s),className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Información Básica"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nombre del Dispositivo"}),e.jsx("input",{...l("name"),className:`input ${u.name?"input-error":""}`,placeholder:"Ej: Máquina de Grúa 1"}),u.name&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:u.name.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Localidad"}),e.jsx("input",{...l("locality"),className:`input ${u.locality?"input-error":""}`,placeholder:"Ej: Centro Comercial Plaza Norte"}),u.locality&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:u.locality.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tipo de Dispositivo"}),e.jsxs("select",{...l("type"),className:`input ${u.type?"input-error":""}`,children:[e.jsx("option",{value:"",children:"Seleccionar tipo"}),x.map(d=>e.jsx("option",{value:d.value,children:d.label},d.value))]}),u.type&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:u.type.message})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Campos de Datos"}),e.jsxs("button",{type:"button",onClick:p,className:"btn btn-primary",children:[e.jsx(G,{className:"w-4 h-4 mr-2"}),"Agregar Campo"]})]}),e.jsx($,{children:g.map((d,w)=>e.jsxs(C.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"border border-gray-200 rounded-lg p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h4",{className:"font-medium text-gray-900",children:["Campo ",w+1]}),g.length>1&&e.jsx("button",{type:"button",onClick:()=>h(w),className:"text-red-600 hover:text-red-700",children:e.jsx(We,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nombre"}),e.jsx("input",{...l(`fields.${w}.name`),className:"input",placeholder:"Ej: Monedas",onChange:E=>{const D=j(E.target.value);l(`fields.${w}.key`).onChange({target:{value:D}})}})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Clave"}),e.jsx("input",{...l(`fields.${w}.key`),className:"input",placeholder:"coin"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tipo"}),e.jsx("select",{...l(`fields.${w}.type`),className:"input",children:v.map(E=>e.jsx("option",{value:E.value,children:E.label},E.value))})]}),e.jsx("div",{className:"flex items-center",children:e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",...l(`fields.${w}.required`),className:"rounded border-gray-300 text-primary-600 focus:ring-primary-500"}),e.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"Requerido"})]})})]})]},d.id))}),u.fields&&e.jsx("p",{className:"text-sm text-red-600",children:u.fields.message})]}),e.jsxs("div",{className:"flex space-x-3 pt-6 border-t border-gray-200",children:[e.jsx("button",{type:"submit",disabled:r,className:"btn btn-primary flex-1",children:r?"Guardando...":t?"Actualizar":"Crear Dispositivo"}),e.jsx("button",{type:"button",onClick:a,className:"btn btn-secondary",children:"Cancelar"})]})]})}),e.jsx($,{children:i&&e.jsx(C.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:20},className:"lg:sticky lg:top-8",children:e.jsxs("div",{className:"card p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Vista Previa"}),m.name&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 rounded-lg bg-primary-100",children:e.jsx("div",{className:"w-6 h-6 bg-primary-600 rounded"})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("h4",{className:"font-semibold text-gray-900",children:m.name}),e.jsx("p",{className:"text-sm text-gray-500 capitalize",children:m.type})]})]}),e.jsx("div",{className:"space-y-2",children:(S=m.fields)==null?void 0:S.map((d,w)=>d.name&&e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-sm text-gray-600",children:[d.name,":"]}),e.jsx("span",{className:"font-medium",children:d.type==="number"?"0":d.type==="boolean"?"false":"N/A"})]},w))}),e.jsx("button",{className:"btn btn-primary w-full",disabled:!0,children:"Ver Reportes"})]})]})})})]})]})})}function De(){const{data:t,isLoading:s}=te(),a=ua(),r=ha(),[i,n]=N.useState(!1),[l,y]=N.useState(null),[b,o]=N.useState("grid"),u=async m=>{try{await a.mutateAsync(m),n(!1)}catch(x){console.error("Error creating device:",x)}},g=async m=>{if(l)try{await r.mutateAsync({id:l.id,...m,fields:m.fields.map((x,v)=>{var p,j;return{id:((j=(p=l.fields)==null?void 0:p[v])==null?void 0:j.id)??"",...x}})}),y(null)}catch(x){console.error("Error updating device:",x)}},f=m=>{y(m)},h=()=>{n(!1),y(null)};return i||l?e.jsx(Sa,{device:l||void 0,onSubmit:l?g:u,onCancel:h,isLoading:a.isPending||r.isPending}):e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Gestión de Dispositivos"}),e.jsx("p",{className:"mt-2 text-gray-600",children:"Crea, edita y administra tus dispositivos ESP32"})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"flex rounded-lg border border-gray-300",children:[e.jsx("button",{onClick:()=>o("grid"),className:`p-2 ${b==="grid"?"bg-primary-100 text-primary-700":"text-gray-500"}`,children:e.jsx(Zs,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>o("list"),className:`p-2 ${b==="list"?"bg-primary-100 text-primary-700":"text-gray-500"}`,children:e.jsx(ea,{className:"w-4 h-4"})})]}),e.jsxs("button",{onClick:()=>n(!0),className:"btn btn-primary",children:[e.jsx(G,{className:"w-4 h-4 mr-2"}),"Nuevo Dispositivo"]})]})]}),s?e.jsxs("div",{className:"flex items-center justify-center h-64",children:[e.jsx("div",{className:"loading-spinner w-8 h-8"}),e.jsx("span",{className:"ml-3 text-gray-600",children:"Cargando dispositivos..."})]}):(t==null?void 0:t.length)===0?e.jsxs(C.div,{initial:{opacity:0},animate:{opacity:1},className:"text-center py-12",children:[e.jsx("div",{className:"w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(G,{className:"w-12 h-12 text-gray-400"})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No hay dispositivos configurados"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"Comienza creando tu primer dispositivo ESP32"}),e.jsxs("button",{onClick:()=>n(!0),className:"btn btn-primary",children:[e.jsx(G,{className:"w-4 h-4 mr-2"}),"Crear Primer Dispositivo"]})]}):e.jsx($,{children:b==="grid"?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:t==null?void 0:t.map(m=>e.jsx(C.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},children:e.jsx(Ge,{device:m,onEdit:f})},m.id))}):e.jsx("div",{className:"card overflow-hidden",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"table-header",children:"Dispositivo"}),e.jsx("th",{className:"table-header",children:"Tipo"}),e.jsx("th",{className:"table-header",children:"Estado"}),e.jsx("th",{className:"table-header",children:"Última Actualización"}),e.jsx("th",{className:"table-header",children:"Acciones"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:t==null?void 0:t.map(m=>e.jsxs(C.tr,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"hover:bg-gray-50",children:[e.jsx("td",{className:"table-cell",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"h-10 w-10 rounded-lg bg-primary-100 flex items-center justify-center",children:e.jsx("span",{className:"text-primary-600 font-medium",children:m.name.charAt(0)})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:m.name}),e.jsx("div",{className:"text-sm text-gray-500",children:m.id})]})]})}),e.jsx("td",{className:"table-cell",children:e.jsx("span",{className:"capitalize text-sm text-gray-900",children:m.type})}),e.jsx("td",{className:"table-cell",children:e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${m.status==="online"?"status-online":m.status==="offline"?"status-offline":"status-unknown"}`,children:m.status==="online"?"En línea":m.status==="offline"?"Desconectado":"Desconocido"})}),e.jsx("td",{className:"table-cell text-sm text-gray-500",children:new Date(m.lastHeartbeat).toLocaleString()}),e.jsx("td",{className:"table-cell",children:e.jsx("button",{onClick:()=>f(m),className:"btn btn-secondary text-xs py-1 px-2",children:"Editar"})})]},m.id))})]})})})]})}function Ye(t,s,a){return me({queryKey:["reports",t,s,a],queryFn:async()=>{const r=new URLSearchParams;t!=="all"&&r.append("deviceId",t),s&&r.append("startDate",s),a&&r.append("endDate",a);const i=await fetch(`/api/reports?${r}`);if(!i.ok)throw new Error("Failed to fetch reports");return i.json()}})}/*!
 * chartjs-adapter-date-fns v3.0.0
 * https://www.chartjs.org
 * (c) 2022 chartjs-adapter-date-fns Contributors
 * Released under the MIT license
 */const Da={datetime:"MMM d, yyyy, h:mm:ss aaaa",millisecond:"h:mm:ss.SSS aaaa",second:"h:mm:ss aaaa",minute:"h:mm aaaa",hour:"ha",day:"MMM d",week:"PP",month:"MMM yyyy",quarter:"qqq - yyyy",year:"yyyy"};Kt._date.override({_id:"date-fns",formats:function(){return Da},parse:function(t,s){if(t===null||typeof t>"u")return null;const a=typeof t;return a==="number"||t instanceof Date?t=Bt(t):a==="string"&&(typeof s=="string"?t=Wt(t,s,new Date,this.options):t=Ut(t,this.options)),Gt(t)?t.getTime():null},format:function(t,s){return I(t,s,this.options)},add:function(t,s,a){switch(a){case"millisecond":return Vt(t,s);case"second":return Ht(t,s);case"minute":return Rt(t,s);case"hour":return _t(t,s);case"day":return qt(t,s);case"week":return $t(t,s);case"month":return Pe(t,s);case"quarter":return Ot(t,s);case"year":return Ft(t,s);default:return t}},diff:function(t,s,a){switch(a){case"millisecond":return Lt(t,s);case"second":return zt(t,s);case"minute":return At(t,s);case"hour":return It(t,s);case"day":return Pt(t,s);case"week":return Tt(t,s);case"month":return Et(t,s);case"quarter":return Mt(t,s);case"year":return Ct(t,s);default:return 0}},startOf:function(t,s,a){switch(s){case"second":return Dt(t);case"minute":return St(t);case"hour":return wt(t);case"day":return kt(t);case"week":return fe(t);case"isoWeek":return fe(t,{weekStartsOn:+a});case"month":return oe(t);case"quarter":return Nt(t);case"year":return vt(t);default:return t}},endOf:function(t,s){switch(s){case"second":return jt(t);case"minute":return bt(t);case"hour":return ft(t);case"day":return pt(t);case"week":return gt(t);case"month":return Te(t);case"quarter":return yt(t);case"year":return ht(t);default:return t}}});Zt.register(Xt,es,ts,ss,as,rs,ns,is,ls,os,cs);function ie({type:t,data:s,options:a,height:r=300}){const i={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top",labels:{usePointStyle:!0,padding:20,font:{size:12,family:"Inter"}}},tooltip:{backgroundColor:"rgba(0, 0, 0, 0.8)",titleColor:"white",bodyColor:"white",borderColor:"rgba(255, 255, 255, 0.1)",borderWidth:1,cornerRadius:8,displayColors:!0,usePointStyle:!0}},scales:t!=="doughnut"?{x:{grid:{color:"rgba(0, 0, 0, 0.05)"},ticks:{font:{size:11,family:"Inter"},color:"#6b7280"}},y:{beginAtZero:!0,grid:{color:"rgba(0, 0, 0, 0.05)"},ticks:{font:{size:11,family:"Inter"},color:"#6b7280"}}}:void 0,...a},n={data:s,options:i};return!s.datasets||s.datasets.length===0||!s.labels||s.labels.length===0?e.jsx("div",{className:"flex items-center justify-center h-64 text-gray-500",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-3",children:e.jsx("svg",{className:"w-8 h-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})}),e.jsx("p",{className:"text-sm font-medium",children:"No hay datos disponibles"}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Los datos aparecerán aquí cuando estén disponibles"})]})}):e.jsxs("div",{className:"chart-container",style:{height:r},children:[t==="line"&&e.jsx(ds,{...n}),t==="bar"&&e.jsx(ms,{...n}),t==="doughnut"&&e.jsx(xs,{...n})]})}function Ca({onDateSelect:t,onRangeSelect:s,selectedDate:a,highlightedDates:r=[],mode:i="single"}){const[n,l]=N.useState(a||new Date),[y,b]=N.useState([]),o=oe(n),u=Te(n),g=Jt({start:o,end:u}),f=o.getDay(),h=[];for(let d=0;d<f;d++)h.push(null);h.push(...g);const m=d=>{if(i==="single")t(d);else if(i==="range")if(y.length===0||y.length===2)b([d]);else{const w=[y[0],d].sort((E,D)=>E.getTime()-D.getTime());b(w),s==null||s(w[0],w[1])}},x=d=>i==="single"?(a==null?void 0:a.toDateString())===d.toDateString():y.some(w=>w.toDateString()===d.toDateString()),v=d=>i==="range"&&y.length===2?d>=y[0]&&d<=y[1]:!1,p=d=>r.some(w=>w.toDateString()===d.toDateString()),j=d=>d.toDateString()===new Date().toDateString(),S=["Dom","Lun","Mar","Mié","Jue","Vie","Sáb"];return e.jsxs(C.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"card p-6 max-w-md mx-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("button",{onClick:()=>l(Yt(n,1)),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:e.jsx(qe,{className:"w-4 h-4"})}),e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:I(n,"MMMM yyyy")}),e.jsx("button",{onClick:()=>l(Pe(n,1)),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:e.jsx(_e,{className:"w-4 h-4"})})]}),e.jsx("div",{className:"grid grid-cols-7 gap-1 mb-2",children:S.map(d=>e.jsx("div",{className:"p-2 text-center text-xs font-medium text-gray-500",children:d},d))}),e.jsx("div",{className:"grid grid-cols-7 gap-1",children:h.map((d,w)=>e.jsx("div",{className:"aspect-square",children:d?e.jsxs("button",{onClick:()=>m(d),className:`
                  w-full h-full flex items-center justify-center text-sm font-medium rounded-lg transition-all duration-200
                  ${x(d)?"bg-primary-600 text-white":v(d)?"bg-primary-100 text-primary-700":j(d)?"bg-primary-100 text-primary-700 font-semibold":p(d)?"bg-success-100 text-success-700":"text-gray-700 hover:bg-gray-100"}
                  ${d.getMonth()!==n.getMonth()?"text-gray-400":""}
                `,children:[d.getDate(),p(d)&&e.jsx("div",{className:"absolute top-1 right-1 w-2 h-2 bg-success-500 rounded-full"})]}):e.jsx("div",{className:"w-full h-full"})},w))}),e.jsxs("div",{className:"mt-6 pt-4 border-t border-gray-200",children:[e.jsx("p",{className:"text-sm font-medium text-gray-700 mb-3",children:"Accesos rápidos:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:[{label:"Hoy",date:new Date},{label:"Ayer",date:new Date(Date.now()-24*60*60*1e3)},{label:"Esta semana",date:new Date},{label:"Este mes",date:oe(new Date)}].map(d=>e.jsx("button",{onClick:()=>m(d.date),className:"btn btn-ghost text-xs py-1 px-3",children:d.label},d.label))})]})]})}function Ma(){const[t,s]=Ke(),a=t.get("device"),[r,i]=N.useState("7d"),[n,l]=N.useState(new Date),[y,b]=N.useState(!1),{data:o,isLoading:u}=te(),g=(()=>{const c=new Date;switch(r){case"24h":c.setDate(c.getDate()-1);break;case"7d":c.setDate(c.getDate()-7);break;case"30d":c.setDate(c.getDate()-30);break;case"90d":c.setDate(c.getDate()-90);break;default:c.setDate(c.getDate()-7)}return I(c,"yyyy-MM-dd")})(),f=I(new Date,"yyyy-MM-dd"),{data:h,isLoading:m}=Ye(a||"all",g,f),x=a?o==null?void 0:o.find(c=>c.id===a):null,v=[{value:"24h",label:"Últimas 24h"},{value:"7d",label:"Última semana"},{value:"30d",label:"Último mes"},{value:"90d",label:"Últimos 3 meses"}],p=c=>{c==="all"?t.delete("device"):t.set("device",c),s(t)},j=c=>{l(c),b(!1)};if(u||m)return e.jsxs("div",{className:"flex items-center justify-center h-64",children:[e.jsx(ta,{className:"w-8 h-8 animate-spin text-primary-600"}),e.jsx("span",{className:"ml-3 text-gray-600",children:"Cargando analytics..."})]});const S=(o==null?void 0:o.length)||0,d=(o==null?void 0:o.filter(c=>c.status==="online").length)||0,w=(o==null?void 0:o.filter(c=>c.status==="offline").length)||0,E=S>0?Math.round(d/S*100):0,D=(h==null?void 0:h.reduce((c,P)=>{const z=P.data.coin||0;return c+z},0))||0,L=(()=>{if(!h||h.length===0)return 0;const c=Math.ceil((new Date(f).getTime()-new Date(g).getTime())/(1e3*60*60*24));return Math.round(D/Math.max(c,1))})(),M=[{title:"Total Coins",value:D.toLocaleString(),change:0,changeType:"increase",icon:K,color:"from-yellow-500 to-yellow-600"},{title:"Promedio Diario",value:L.toLocaleString(),change:0,changeType:"increase",icon:B,color:"from-green-500 to-green-600"},{title:"Dispositivos Activos",value:d.toString(),change:0,changeType:"increase",icon:B,color:"from-blue-500 to-blue-600"},{title:"Eficiencia",value:`${E}%`,change:0,changeType:"increase",icon:ee,color:"from-purple-500 to-purple-600"}],T=(h==null?void 0:h.reduce((c,P)=>{const z=I(new Date(P.timestamp),"yyyy-MM-dd"),R=P.data.coin||0;return c[z]=(c[z]||0)+R,c},{}))||{},F=Object.keys(T).sort(),A=F.map(c=>T[c]),O=(h==null?void 0:h.reduce((c,P)=>{const z=o==null?void 0:o.find(R=>R.id===P.deviceId);if(z){const R=P.data.coin||0;c[z.type]=(c[z.type]||0)+R}return c},{}))||{},W={labels:F.map(c=>I(new Date(c),"dd/MM")),datasets:[{label:"Coins por Día",data:A,borderColor:"rgb(245, 158, 11)",backgroundColor:"rgba(245, 158, 11, 0.1)",fill:!0,tension:.4}]},se={labels:Object.keys(O).map(c=>{switch(c){case"grua":return"Grúas";case"expendedora":return"Expendedoras";case"videojuego":return"Videojuegos";case"ticketera":return"Ticketeras";default:return c}}),datasets:[{label:"Coins por Tipo de Dispositivo",data:Object.values(O),backgroundColor:["rgba(245, 158, 11, 0.8)","rgba(16, 185, 129, 0.8)","rgba(59, 130, 246, 0.8)","rgba(139, 92, 246, 0.8)","rgba(236, 72, 153, 0.8)"],borderColor:["rgb(245, 158, 11)","rgb(16, 185, 129)","rgb(59, 130, 246)","rgb(139, 92, 246)","rgb(236, 72, 153)"],borderWidth:1}]},ae={labels:["En línea","Desconectado"],datasets:[{data:[d,w],backgroundColor:["rgba(16, 185, 129, 0.8)","rgba(239, 68, 68, 0.8)"],borderColor:["rgb(16, 185, 129)","rgb(239, 68, 68)"],borderWidth:2}]};return e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Analytics"}),e.jsx("p",{className:"mt-2 text-gray-600",children:"Análisis detallado y métricas de rendimiento"})]}),e.jsxs("div",{className:"mt-4 sm:mt-0 flex items-center space-x-4",children:[e.jsxs("button",{onClick:()=>b(!y),className:"btn btn-secondary",children:[e.jsx(ye,{className:"w-4 h-4 mr-2"}),I(n,"dd/MM/yyyy")]}),e.jsxs("button",{className:"btn btn-secondary",children:[e.jsx(Re,{className:"w-4 h-4 mr-2"}),"Exportar"]})]})]}),e.jsx("div",{className:"card p-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Dispositivo"}),e.jsxs("select",{value:a||"all",onChange:c=>p(c.target.value),className:"input",children:[e.jsx("option",{value:"all",children:"Todos los dispositivos"}),o==null?void 0:o.map(c=>e.jsx("option",{value:c.id,children:c.name},c.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Período"}),e.jsx("select",{value:r,onChange:c=>i(c.target.value),className:"input",children:v.map(c=>e.jsx("option",{value:c.value,children:c.label},c.value))})]})]})}),y&&e.jsx(C.div,{initial:{opacity:0},animate:{opacity:1},className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",onClick:()=>b(!1),children:e.jsx(C.div,{initial:{scale:.95},animate:{scale:1},onClick:c=>c.stopPropagation(),className:"max-w-md w-full mx-4",children:e.jsx(Ca,{onDateSelect:j,selectedDate:n})})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:M.map((c,P)=>{const z=c.icon;return e.jsxs(C.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:P*.1},className:`metric-card bg-gradient-to-r ${c.color}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx(z,{className:"w-8 h-8 text-white/80"}),c.change!==0&&e.jsxs("div",{className:"flex items-center text-white/80",children:[c.changeType==="increase"?e.jsx(K,{className:"w-4 h-4 mr-1"}):e.jsx(Ue,{className:"w-4 h-4 mr-1"}),e.jsxs("span",{className:"text-sm font-medium",children:[Math.abs(c.change),"%"]})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-white/80 text-sm font-medium",children:c.title}),e.jsx("p",{className:"text-2xl font-bold text-white",children:c.value})]})]},c.title)})}),o&&o.length>0?e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[e.jsxs(C.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},className:"card p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Coins por Día"}),e.jsx(ie,{type:"line",data:W,height:300})]}),e.jsxs(C.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},className:"card p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Coins por Tipo de Dispositivo"}),Object.keys(O).length>0?e.jsx(ie,{type:"bar",data:se,height:300}):e.jsx("div",{className:"flex items-center justify-center h-64 text-gray-500",children:"No hay datos disponibles"})]}),e.jsxs(C.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"card p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Estado de Dispositivos"}),S>0?e.jsx(ie,{type:"doughnut",data:ae,height:300}):e.jsx("div",{className:"flex items-center justify-center h-64 text-gray-500",children:"No hay dispositivos configurados"})]}),e.jsxs(C.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"card p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Top Dispositivos por Coins"}),e.jsxs("div",{className:"space-y-4",children:[o==null?void 0:o.slice(0,5).map(c=>{const P=(h==null?void 0:h.filter(z=>z.deviceId===c.id).reduce((z,R)=>z+(R.data.coin||0),0))||0;return e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`w-3 h-3 rounded-full mr-3 ${c.status==="online"?"bg-green-500":c.status==="offline"?"bg-red-500":"bg-gray-400"}`}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:c.name}),e.jsxs("p",{className:"text-sm text-gray-500 capitalize",children:[c.type," - ",c.locality]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"font-bold text-yellow-600",children:[P," coins"]}),e.jsx("p",{className:`text-xs ${c.status==="online"?"text-green-600":c.status==="offline"?"text-red-600":"text-gray-600"}`,children:c.status==="online"?"En línea":c.status==="offline"?"Desconectado":"Desconocido"})]})]},c.id)}),o&&o.length>5&&e.jsxs("p",{className:"text-sm text-gray-500 text-center",children:["Y ",o.length-5," dispositivos más..."]})]})]})]}):e.jsxs(C.div,{initial:{opacity:0},animate:{opacity:1},className:"card p-12 text-center",children:[e.jsx(de,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No hay dispositivos configurados"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"Agrega algunos dispositivos para ver las estadísticas y análisis"}),e.jsx("button",{onClick:()=>window.location.href="/devices/new",className:"btn btn-primary",children:"Agregar Dispositivo"})]}),x&&e.jsxs(C.div,{initial:{opacity:0},animate:{opacity:1},className:"card p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:["Detalles de ",x.name]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Tipo"}),e.jsxs("p",{className:"text-lg font-semibold text-gray-900 capitalize",children:[x.type," - ",x.locality]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Estado"}),e.jsx("p",{className:`text-lg font-semibold ${x.status==="online"?"text-green-600":x.status==="offline"?"text-red-600":"text-gray-600"}`,children:x.status==="online"?"En línea":x.status==="offline"?"Desconectado":"Desconocido"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Última actualización"}),e.jsx("p",{className:"text-lg font-semibold text-gray-900",children:I(new Date(x.lastHeartbeat),"dd/MM/yyyy HH:mm")})]})]}),e.jsxs("div",{className:"mt-6 pt-6 border-t border-gray-200",children:[e.jsx("h4",{className:"text-md font-semibold text-gray-900 mb-3",children:"Estadísticas del Período"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 p-3 rounded-lg",children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Total Coins"}),e.jsx("p",{className:"text-lg font-semibold text-yellow-600",children:(h==null?void 0:h.filter(c=>c.deviceId===x.id).reduce((c,P)=>c+(P.data.coin||0),0))||0})]}),e.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 p-3 rounded-lg",children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Eventos"}),e.jsx("p",{className:"text-lg font-semibold text-blue-600",children:(h==null?void 0:h.filter(c=>c.deviceId===x.id).length)||0})]}),e.jsxs("div",{className:"bg-green-50 dark:bg-green-900/20 p-3 rounded-lg",children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Promedio/Día"}),e.jsx("p",{className:"text-lg font-semibold text-green-600",children:Math.round(((h==null?void 0:h.filter(c=>c.deviceId===x.id).reduce((c,P)=>c+(P.data.coin||0),0))||0)/Math.max(1,Math.ceil((new Date(f).getTime()-new Date(g).getTime())/(1e3*60*60*24))))})]}),e.jsxs("div",{className:"bg-purple-50 dark:bg-purple-900/20 p-3 rounded-lg",children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Estado"}),e.jsx("p",{className:`text-lg font-semibold ${x.status==="online"?"text-green-600":x.status==="offline"?"text-red-600":"text-gray-600"}`,children:x.status==="online"?"En línea":x.status==="offline"?"Desconectado":"Desconocido"})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("h5",{className:"text-sm font-semibold text-gray-900 mb-2",children:"Datos Actuales del Dispositivo"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:x.fields.map(c=>e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 p-3 rounded-lg",children:[e.jsx("p",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:c.name}),e.jsx("p",{className:"text-lg font-semibold text-gray-900",children:x.data[c.key]??"N/A"})]},c.id))})]})]})]})]})}function Ea({onIntervalConfirm:t,onDateRangeChange:s}){const[a,r]=N.useState(new Date),[i,n]=N.useState(null),[l,y]=N.useState(null),[b,o]=N.useState(!1),[u,g]=N.useState(null),f=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],h=["Dom","Lun","Mar","Mié","Jue","Vie","Sáb"],m=M=>new Date(M.getFullYear(),M.getMonth()+1,0).getDate(),x=M=>new Date(M.getFullYear(),M.getMonth(),1).getDay(),v=(M,T)=>!M||!T?!1:M.getDate()===T.getDate()&&M.getMonth()===T.getMonth()&&M.getFullYear()===T.getFullYear(),p=(M,T,F)=>{if(!T||!F)return!1;const A=M.getTime(),O=T.getTime(),W=F.getTime();return A>=O&&A<=W},j=M=>{const T=new Date(a.getFullYear(),a.getMonth(),M);!i||i&&l?(n(T),y(null),o(!0),g(null),s==null||s(T,null)):b&&(T>=i?(y(T),o(!1),s==null||s(i,T)):(n(T),y(null),s==null||s(T,null)))},S=()=>{r(new Date(a.getFullYear(),a.getMonth()-1,1))},d=()=>{r(new Date(a.getFullYear(),a.getMonth()+1,1))},w=()=>{if(i&&l){const M={start:i,end:l,days:Math.ceil((l.getTime()-i.getTime())/864e5)+1};g(M),t==null||t(i,l)}},E=()=>{n(null),y(null),o(!1),g(null),s==null||s(null,null)},D=M=>M.toLocaleDateString("es-ES",{day:"numeric",month:"long",year:"numeric"}),L=()=>{const M=m(a),T=x(a),F=[];for(let A=0;A<T;A++)F.push(e.jsx("div",{className:"h-10 w-10"},`empty-${A}`));for(let A=1;A<=M;A++){const O=new Date(a.getFullYear(),a.getMonth(),A),W=v(O,i),se=v(O,l),ae=p(O,i,l),c=v(O,new Date);let P="h-10 w-10 flex items-center justify-center rounded-lg cursor-pointer transition-all duration-200 hover:bg-blue-100 ";W?P+="bg-blue-500 dark:bg-blue-600 text-white font-bold shadow-md hover:bg-blue-600 dark:hover:bg-blue-700 ":se?P+="bg-green-500 dark:bg-green-600 text-white font-bold shadow-md hover:bg-green-600 dark:hover:bg-green-700 ":ae?P+="bg-blue-200 dark:bg-blue-800 text-blue-800 dark:text-blue-200 font-medium ":c?P+="bg-gray-200 dark:bg-gray-600 text-gray-900 dark:text-gray-100 font-medium ":P+="text-gray-700 dark:text-gray-300 hover:text-blue-600 dark:hover:text-blue-400 hover:bg-blue-100 dark:hover:bg-blue-900/30 ",F.push(e.jsx("div",{className:P,onClick:()=>j(A),children:A},A))}return F};return e.jsxs(C.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"max-w-4xl mx-auto p-6 bg-white dark:bg-gray-800 rounded-lg shadow-lg",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx(ye,{className:"w-6 h-6 text-blue-600"}),e.jsx("h2",{className:"text-2xl font-bold text-gray-800 dark:text-gray-100",children:"📅 Selecciona el Período de Reportes"})]}),e.jsxs("div",{className:"grid lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2",children:[e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("button",{onClick:S,className:"p-2 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-600 text-gray-600 dark:text-gray-300 transition-colors",children:e.jsx(qe,{className:"w-5 h-5"})}),e.jsxs("h3",{className:"text-lg font-semibold text-gray-800 dark:text-gray-100",children:[f[a.getMonth()]," ",a.getFullYear()]}),e.jsx("button",{onClick:d,className:"p-2 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-600 text-gray-600 dark:text-gray-300 transition-colors",children:e.jsx(_e,{className:"w-5 h-5"})})]}),e.jsx("div",{className:"grid grid-cols-7 gap-1 mb-2",children:h.map(M=>e.jsx("div",{className:"h-8 flex items-center justify-center text-sm font-medium text-gray-600 dark:text-gray-300",children:M},M))}),e.jsx("div",{className:"grid grid-cols-7 gap-1",children:L()})]}),e.jsxs("div",{className:"mt-4 flex flex-wrap gap-4 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 bg-blue-500 dark:bg-blue-600 rounded"}),e.jsx("span",{className:"text-gray-700 dark:text-gray-300",children:"Fecha de inicio"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 bg-green-500 dark:bg-green-600 rounded"}),e.jsx("span",{className:"text-gray-700 dark:text-gray-300",children:"Fecha de fin"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 bg-blue-200 dark:bg-blue-800 rounded"}),e.jsx("span",{className:"text-gray-700 dark:text-gray-300",children:"Período seleccionado"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 bg-gray-200 dark:bg-gray-600 rounded"}),e.jsx("span",{className:"text-gray-700 dark:text-gray-300",children:"Hoy"})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4",children:[e.jsx("h4",{className:"font-semibold text-blue-800 dark:text-blue-300 mb-2",children:"Instrucciones:"}),e.jsxs("div",{className:"text-sm text-blue-700 dark:text-blue-300 space-y-2",children:[!i&&e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"w-2 h-2 bg-blue-500 rounded-full mr-2"}),e.jsx("p",{children:"Haz clic en un día para seleccionar el inicio del período"})]}),i&&!l&&e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"w-2 h-2 bg-green-500 rounded-full mr-2"}),e.jsx("p",{children:"Ahora selecciona el día final del período"})]}),i&&l&&e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"w-2 h-2 bg-purple-500 rounded-full mr-2"}),e.jsx("p",{children:"¡Perfecto! Confirma el período o selecciona uno nuevo"})]})]})]}),e.jsx($,{children:i&&e.jsxs(C.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg p-4",children:[e.jsx("h4",{className:"font-semibold text-gray-800 dark:text-gray-100 mb-3",children:"Intervalo Actual:"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700 dark:text-gray-300",children:"Inicio:"}),e.jsx("div",{className:"text-blue-600 font-medium",children:D(i)})]}),l&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700 dark:text-gray-300",children:"Fin:"}),e.jsx("div",{className:"text-green-600 font-medium",children:D(l)})]}),e.jsxs("div",{className:"border-t pt-2",children:[e.jsx("span",{className:"font-medium text-gray-700 dark:text-gray-300",children:"Duración:"}),e.jsxs("div",{className:"text-purple-600 font-bold",children:[Math.ceil((l.getTime()-i.getTime())/(1e3*60*60*24))+1," días"]})]})]})]})]})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx($,{children:i&&l&&e.jsxs(C.button,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},onClick:w,className:"w-full flex items-center justify-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[e.jsx(Q,{className:"w-4 h-4"}),"Confirmar Intervalo"]})}),e.jsxs("button",{onClick:E,className:"w-full flex items-center justify-center gap-2 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors",children:[e.jsx(Ve,{className:"w-4 h-4"}),"Limpiar Selección"]})]}),e.jsx($,{children:u&&e.jsxs(C.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Q,{className:"w-4 h-4 text-green-600"}),e.jsx("h4",{className:"font-semibold text-green-800 dark:text-green-300",children:"Período Confirmado"})]}),e.jsxs("div",{className:"text-sm text-green-700 dark:text-green-300",children:[e.jsxs("div",{children:["Del ",D(u.start)]}),e.jsxs("div",{children:["al ",D(u.end)]}),e.jsxs("div",{className:"font-bold mt-1",children:["(",u.days," días)"]})]})]})})]})]})]})}function Ta({deviceId:t,onClose:s,onConfigSave:a}){const[r,i]=N.useState({pago:1,tiempo:1e3,tiempoFuerzaFuerte:500,fuerza:50,tipoBarrera:"infrarrojo",modoDisplay:"contadores",borrarContadores:!1}),[n,l]=N.useState(0),[y,b]=N.useState(!1),[o,u]=N.useState(!1),[g,f]=N.useState(!1),[h,m]=N.useState(0),x=[{id:"connection",title:"Conexión",icon:Y},{id:"display",title:"Modo Display",icon:He},{id:"counters",title:"Contadores",icon:Ve},{id:"payment",title:"Pago",icon:Be},{id:"timing",title:"Tiempos",icon:Js},{id:"force",title:"Fuerza",icon:ee},{id:"barrier",title:"Barrera",icon:Ks},{id:"test",title:"Pruebas",icon:Ne},{id:"save",title:"Guardar",icon:we}],v=async()=>{b(!0),await new Promise(E=>setTimeout(E,2e3)),u(!0),b(!1),l(1)},p=()=>{n<x.length-1&&l(n+1)},j=()=>{n>0&&l(n-1)},S=async()=>{f(!0),await new Promise(E=>setTimeout(E,1500)),a==null||a(r),f(!1),s()},d=(E,D)=>{i(L=>({...L,[E]:D}))},w=()=>{switch(x[n].id){case"connection":return e.jsxs("div",{className:"text-center space-y-6",children:[e.jsx("div",{className:"w-24 h-24 mx-auto bg-blue-100 rounded-full flex items-center justify-center",children:e.jsx(Y,{className:"w-12 h-12 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Conectar con Arduino"}),e.jsxs("p",{className:"text-gray-600 mb-6",children:["Dispositivo: ",t]}),o?e.jsxs("div",{className:"flex items-center justify-center text-green-600",children:[e.jsx(Q,{className:"w-5 h-5 mr-2"}),"Conectado exitosamente"]}):e.jsx("button",{onClick:v,disabled:y,className:"btn btn-primary",children:y?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"loading-spinner w-4 h-4 mr-2"}),"Conectando..."]}):"Conectar"})]})]});case"display":return e.jsxs("div",{className:"space-y-6",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:"Modo de Display"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("label",{className:"flex items-center p-4 border rounded-lg cursor-pointer hover:bg-gray-50",children:[e.jsx("input",{type:"radio",name:"modoDisplay",value:"contadores",checked:r.modoDisplay==="contadores",onChange:D=>d("modoDisplay",D.target.value),className:"mr-3"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:"Modo Contadores"}),e.jsx("div",{className:"text-sm text-gray-500",children:"Muestra todos los contadores"})]})]}),e.jsxs("label",{className:"flex items-center p-4 border rounded-lg cursor-pointer hover:bg-gray-50",children:[e.jsx("input",{type:"radio",name:"modoDisplay",value:"coin",checked:r.modoDisplay==="coin",onChange:D=>d("modoDisplay",D.target.value),className:"mr-3"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:"Modo Coin"}),e.jsx("div",{className:"text-sm text-gray-500",children:"Muestra solo las monedas"})]})]})]})]});case"counters":return e.jsxs("div",{className:"space-y-6",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:"Gestión de Contadores"}),e.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(Ne,{className:"w-5 h-5 text-yellow-600 mr-2"}),e.jsx("span",{className:"font-medium text-yellow-800",children:"¡Atención!"})]}),e.jsx("p",{className:"text-yellow-700 mt-1",children:"Esta acción borrará todos los contadores de manera permanente."})]}),e.jsxs("label",{className:"flex items-center p-4 border rounded-lg cursor-pointer hover:bg-gray-50",children:[e.jsx("input",{type:"checkbox",checked:r.borrarContadores,onChange:D=>d("borrarContadores",D.target.checked),className:"mr-3"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:"Borrar Contadores"}),e.jsx("div",{className:"text-sm text-gray-500",children:"Reinicia COIN, CONTSALIDA y BANK a cero"})]})]})]});case"payment":return e.jsxs("div",{className:"space-y-6",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:"Configuración de Pago"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Valor de Pago"}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("button",{onClick:()=>d("pago",Math.max(1,r.pago-1)),className:"btn btn-secondary w-10 h-10 p-0",children:"-"}),e.jsx("div",{className:"text-2xl font-bold text-center w-16",children:r.pago}),e.jsx("button",{onClick:()=>d("pago",r.pago+1),className:"btn btn-secondary w-10 h-10 p-0",children:"+"})]}),e.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Valor mínimo: 1"})]})]});case"timing":return e.jsxs("div",{className:"space-y-6",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:"Configuración de Tiempos"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tiempo Principal (ms)"}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("button",{onClick:()=>d("tiempo",Math.max(500,r.tiempo-10)),className:"btn btn-secondary w-10 h-10 p-0",children:"-"}),e.jsx("div",{className:"text-xl font-bold text-center w-20",children:r.tiempo}),e.jsx("button",{onClick:()=>d("tiempo",Math.min(5e3,r.tiempo+10)),className:"btn btn-secondary w-10 h-10 p-0",children:"+"})]}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Rango: 500-5000ms"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tiempo Fuerza Fuerte (ms)"}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("button",{onClick:()=>d("tiempoFuerzaFuerte",Math.max(0,r.tiempoFuerzaFuerte-10)),className:"btn btn-secondary w-10 h-10 p-0",children:"-"}),e.jsx("div",{className:"text-xl font-bold text-center w-20",children:r.tiempoFuerzaFuerte}),e.jsx("button",{onClick:()=>d("tiempoFuerzaFuerte",Math.min(5e3,r.tiempoFuerzaFuerte+10)),className:"btn btn-secondary w-10 h-10 p-0",children:"+"})]}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Rango: 0-5000ms"})]})]});case"force":return e.jsxs("div",{className:"space-y-6",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:"Configuración de Fuerza"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nivel de Fuerza (%)"}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("button",{onClick:()=>d("fuerza",Math.max(5,r.fuerza-1)),className:"btn btn-secondary w-10 h-10 p-0",children:"-"}),e.jsxs("div",{className:"text-2xl font-bold text-center w-16",children:[r.fuerza,"%"]}),e.jsx("button",{onClick:()=>d("fuerza",Math.min(101,r.fuerza+1)),className:"btn btn-secondary w-10 h-10 p-0",children:"+"})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 mt-4",children:e.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:`${r.fuerza}%`}})}),e.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Rango: 5-101%"})]})]});case"barrier":return e.jsxs("div",{className:"space-y-6",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:"Configuración de Barrera"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("label",{className:"flex items-center p-4 border rounded-lg cursor-pointer hover:bg-gray-50",children:[e.jsx("input",{type:"radio",name:"tipoBarrera",value:"infrarrojo",checked:r.tipoBarrera==="infrarrojo",onChange:D=>d("tipoBarrera",D.target.value),className:"mr-3"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:"Infrarrojo"}),e.jsx("div",{className:"text-sm text-gray-500",children:"Sensor infrarrojo tradicional"})]})]}),e.jsxs("label",{className:"flex items-center p-4 border rounded-lg cursor-pointer hover:bg-gray-50",children:[e.jsx("input",{type:"radio",name:"tipoBarrera",value:"ultrasonido",checked:r.tipoBarrera==="ultrasonido",onChange:D=>d("tipoBarrera",D.target.value),className:"mr-3"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:"Ultrasonido"}),e.jsx("div",{className:"text-sm text-gray-500",children:"Sensor ultrasónico de distancia"})]})]})]})]});case"test":return e.jsxs("div",{className:"space-y-6",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:"Prueba de Barrera"}),e.jsx("div",{className:"bg-gray-50 rounded-lg p-6",children:e.jsxs("div",{className:"text-center space-y-4",children:[e.jsxs("div",{className:"text-3xl font-bold text-blue-600",children:[h," cm"]}),e.jsx("p",{className:"text-gray-600",children:"Distancia detectada"}),e.jsxs("div",{className:"flex justify-center space-x-4",children:[e.jsx("div",{className:`w-4 h-4 rounded-full ${h<10?"bg-red-500":"bg-gray-300"}`}),e.jsx("div",{className:`w-4 h-4 rounded-full ${h>=10&&h<20?"bg-yellow-500":"bg-gray-300"}`}),e.jsx("div",{className:`w-4 h-4 rounded-full ${h>=20?"bg-green-500":"bg-gray-300"}`})]}),e.jsx("button",{onClick:()=>m(Math.floor(Math.random()*50)),className:"btn btn-secondary",children:"Probar Sensor"})]})})]});case"save":return e.jsxs("div",{className:"space-y-6",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:"Resumen de Configuración"}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 space-y-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"font-medium",children:"Modo Display:"}),e.jsx("span",{className:"capitalize",children:r.modoDisplay})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"font-medium",children:"Pago:"}),e.jsx("span",{children:r.pago})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"font-medium",children:"Tiempo:"}),e.jsxs("span",{children:[r.tiempo,"ms"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"font-medium",children:"Tiempo F. Fuerte:"}),e.jsxs("span",{children:[r.tiempoFuerzaFuerte,"ms"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"font-medium",children:"Fuerza:"}),e.jsxs("span",{children:[r.fuerza,"%"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"font-medium",children:"Tipo Barrera:"}),e.jsx("span",{className:"capitalize",children:r.tipoBarrera})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"font-medium",children:"Borrar Contadores:"}),e.jsx("span",{children:r.borrarContadores?"Sí":"No"})]})]}),e.jsx("button",{onClick:S,disabled:g,className:"btn btn-primary w-full",children:g?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"loading-spinner w-4 h-4 mr-2"}),"Guardando..."]}):e.jsxs(e.Fragment,{children:[e.jsx(we,{className:"w-4 h-4 mr-2"}),"Guardar Configuración"]})})]});default:return null}};return e.jsx("div",{className:"fixed inset-0 bg-black dark:bg-black bg-opacity-50 dark:bg-opacity-70 flex items-center justify-center z-50 p-4",children:e.jsxs(C.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(Y,{className:"w-6 h-6 text-blue-600 mr-3"}),e.jsxs("h2",{className:"text-xl font-bold text-gray-900 dark:text-gray-100",children:["Programador Arduino - ",t]})]}),e.jsx("button",{onClick:s,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:e.jsx(ge,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"flex h-[calc(90vh-80px)]",children:[e.jsx("div",{className:"w-64 bg-gray-50 dark:bg-gray-900 border-r border-gray-200 dark:border-gray-700 p-4",children:e.jsx("div",{className:"space-y-2",children:x.map((E,D)=>{const L=E.icon,M=D===n,T=D<n,F=D>n&&!o;return e.jsxs("div",{className:`flex items-center p-3 rounded-lg transition-colors ${M?"bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300 border border-blue-200 dark:border-blue-700":T?"bg-green-50 dark:bg-green-900/20 text-green-700 dark:text-green-400":F?"text-gray-400 dark:text-gray-600":"text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800"}`,children:[e.jsx(L,{className:"w-4 h-4 mr-3"}),e.jsx("span",{className:"text-sm font-medium",children:E.title}),T&&e.jsx(Q,{className:"w-4 h-4 ml-auto text-green-600"})]},E.id)})})}),e.jsxs("div",{className:"flex-1 flex flex-col",children:[e.jsx("div",{className:"flex-1 p-6 overflow-y-auto bg-white dark:bg-gray-800",children:e.jsx($,{mode:"wait",children:e.jsx(C.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.2},children:w()},n)})}),e.jsx("div",{className:"border-t border-gray-200 dark:border-gray-700 p-6 bg-white dark:bg-gray-800",children:e.jsxs("div",{className:"flex justify-between",children:[e.jsx("button",{onClick:j,disabled:n===0,className:"btn btn-secondary",children:"Anterior"}),e.jsxs("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:["Paso ",n+1," de ",x.length]}),n<x.length-1?e.jsx("button",{onClick:p,disabled:!o&&n===0,className:"btn btn-primary",children:"Siguiente"}):e.jsx("button",{onClick:s,className:"btn btn-secondary",children:"Cerrar"})]})})]})]})]})})}function Ce(){const{deviceId:t}=Ze(),[s,a]=N.useState(I(Qt(new Date,7),"yyyy-MM-dd")),[r,i]=N.useState(I(new Date,"yyyy-MM-dd")),[n,l]=N.useState(!1),[y,b]=N.useState(!1),[o,u]=N.useState("table"),{data:g}=te(),{data:f,isLoading:h}=Ye(t,s,r),m=g==null?void 0:g.find(d=>d.id===t),x=(d,w)=>{d&&a(I(d,"yyyy-MM-dd")),w&&i(I(w,"yyyy-MM-dd"))},v=(d,w)=>{a(I(d,"yyyy-MM-dd")),i(I(w,"yyyy-MM-dd")),l(!1),u("table")},p=()=>{if(!f||f.length===0)return;const d=[["Fecha y Hora",...(m==null?void 0:m.fields.map(L=>L.name))||[]].join(","),...f.map(L=>[I(new Date(L.timestamp),"dd/MM/yyyy HH:mm:ss"),...(m==null?void 0:m.fields.map(M=>L.data[M.key]??"N/A"))||[]].join(","))].join(`
`),w=new Blob([d],{type:"text/csv"}),E=window.URL.createObjectURL(w),D=document.createElement("a");D.href=E,D.download=`reportes_${m==null?void 0:m.name}_${s}_${r}.csv`,D.click(),window.URL.revokeObjectURL(E)};if(!m)return e.jsxs("div",{className:"text-center py-12",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Dispositivo no encontrado"}),e.jsx(_,{to:"/dashboard",className:"btn btn-primary mt-4",children:"Volver al Dashboard"})]});const j=()=>m.fields.map(d=>e.jsx("th",{className:"table-header",children:d.name},d.id)),S=d=>m.fields.map(w=>e.jsx("td",{className:"table-cell",children:d.data[w.key]??"N/A"},w.id));return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{children:[e.jsxs(_,{to:"/dashboard",className:"inline-flex items-center text-sm text-gray-500 hover:text-gray-700 mb-4",children:[e.jsx(Gs,{className:"w-4 h-4 mr-1"}),"Volver al Dashboard"]}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:m.name}),e.jsx("p",{className:"mt-2 text-gray-600",children:"Reportes y análisis de datos"})]}),e.jsxs("div",{className:"flex items-center space-x-3 mt-4 sm:mt-0",children:[e.jsxs("button",{onClick:()=>b(!0),className:"btn btn-secondary",children:[e.jsx(Y,{className:"w-4 h-4 mr-2"}),"Programar Arduino"]}),e.jsxs(_,{to:`/analytics?device=${t}`,className:"btn btn-secondary",children:[e.jsx(he,{className:"w-4 h-4 mr-2"}),"Analytics"]})]})]}),e.jsx("div",{className:"card p-6",children:e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-6",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("button",{onClick:()=>u("table"),className:`btn ${o==="table"?"btn-primary":"btn-secondary"}`,children:[e.jsx(ke,{className:"w-4 h-4 mr-2"}),"Tabla"]}),e.jsxs("button",{onClick:()=>{u("calendar"),l(!0)},className:"btn btn-secondary bg-gradient-to-r from-blue-500 to-green-500 text-white hover:from-blue-600 hover:to-green-600 border-0",children:[e.jsx(ye,{className:"w-4 h-4 mr-2"}),"📅 Seleccionar Período"]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-400 bg-gray-100 dark:bg-gray-700 px-3 py-2 rounded-lg",children:[e.jsx("span",{className:"font-medium",children:"Período actual:"})," ",I(new Date(s),"dd/MM/yyyy")," - ",I(new Date(r),"dd/MM/yyyy")]}),e.jsxs("button",{onClick:p,disabled:!f||f.length===0,className:"btn btn-secondary",children:[e.jsx(Re,{className:"w-4 h-4 mr-2"}),"Exportar CSV"]})]})]})}),e.jsx($,{mode:"wait",children:o==="calendar"&&n?e.jsx(C.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},children:e.jsx(Ea,{onIntervalConfirm:v,onDateRangeChange:x})},"calendar"):e.jsxs(C.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"card overflow-hidden",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"table-header",children:"Fecha y Hora"}),j()]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:h?e.jsx("tr",{children:e.jsx("td",{colSpan:m.fields.length+1,className:"px-6 py-8 text-center",children:e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsx("div",{className:"loading-spinner w-6 h-6 mr-3"}),"Cargando reportes..."]})})}):(f==null?void 0:f.length)===0?e.jsx("tr",{children:e.jsx("td",{colSpan:m.fields.length+1,className:"px-6 py-8 text-center text-gray-500",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(ke,{className:"w-8 h-8 text-gray-400 mx-auto"}),e.jsx("p",{children:"No hay reportes para el período seleccionado"}),e.jsxs("p",{className:"text-sm",children:["Del ",I(new Date(s),"dd/MM/yyyy")," al ",I(new Date(r),"dd/MM/yyyy")]})]})})}):f==null?void 0:f.map((d,w)=>e.jsxs(C.tr,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:w*.05},className:"hover:bg-gray-50",children:[e.jsx("td",{className:"table-cell font-medium",children:I(new Date(d.timestamp),"dd/MM/yyyy HH:mm:ss")}),S(d)]},d.id))})]})}),f&&f.length>0&&e.jsx("div",{className:"bg-gray-50 px-6 py-4 border-t border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-600",children:[e.jsxs("span",{children:["Mostrando ",f.length," registro",f.length!==1?"s":""]}),e.jsxs("span",{children:["Período: ",I(new Date(s),"dd/MM/yyyy")," - ",I(new Date(r),"dd/MM/yyyy")]})]})})]},"table")}),e.jsx($,{children:y&&e.jsx(Ta,{deviceId:m.id,onClose:()=>b(!1),onConfigSave:d=>{console.log("Arduino config saved:",d)}})})]})}const Qe=Oe()($e((t,s)=>({isDarkMode:!1,toggleDarkMode:()=>{const a=!s().isDarkMode;t({isDarkMode:a}),a?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")},setDarkMode:a=>{t({isDarkMode:a}),a?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")}}),{name:"theme-storage",onRehydrateStorage:()=>t=>{t!=null&&t.isDarkMode?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")}}));function Pa(){const{isDarkMode:t,toggleDarkMode:s}=Qe();return e.jsx("button",{onClick:s,className:"relative p-2 rounded-lg bg-gray-100 dark:bg-gray-800 hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors",title:t?"Cambiar a modo claro":"Cambiar a modo oscuro",children:e.jsx(C.div,{initial:!1,animate:{rotate:t?180:0},transition:{duration:.3},children:t?e.jsx(ca,{className:"w-5 h-5 text-yellow-500"}):e.jsx(na,{className:"w-5 h-5 text-gray-600"})})})}function Ia({children:t}){const{user:s,logout:a}=ue(),{isDarkMode:r}=Qe(),i=Xe(),[n,l]=N.useState(!1);N.useEffect(()=>{l(!1)},[i.pathname]),N.useEffect(()=>{const o=u=>{const g=document.getElementById("sidebar"),f=document.getElementById("menu-button");n&&g&&f&&!g.contains(u.target)&&!f.contains(u.target)&&l(!1)};if(n)return document.addEventListener("mousedown",o),()=>document.removeEventListener("mousedown",o)},[n]);const y=[{name:"Dashboard",href:"/dashboard",icon:Xs},{name:"Analytics",href:"/analytics",icon:K},{name:"Device Manager",href:"/devices",icon:Qs},{name:"Reports",href:"/reports",icon:he},{name:"Settings",href:"/settings",icon:Be}],b=o=>o==="/dashboard"?i.pathname==="/"||i.pathname==="/dashboard":i.pathname.startsWith(o);return e.jsxs("div",{className:"h-screen bg-gray-50 dark:bg-gray-900 flex overflow-hidden",children:[e.jsx($,{children:n&&e.jsx(C.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-40 bg-gray-600 dark:bg-gray-900 bg-opacity-75 lg:hidden",onClick:()=>l(!1)})}),e.jsx("div",{className:`
        fixed inset-y-0 left-0 z-50 w-64 bg-white dark:bg-gray-800 shadow-large transform transition-transform duration-300 ease-in-out
        lg:translate-x-0 lg:static lg:inset-0 lg:flex lg:flex-col
        ${n?"translate-x-0":"-translate-x-full"}
      `,id:"sidebar",children:e.jsxs("div",{className:"flex h-full flex-col",children:[e.jsxs("div",{className:"flex h-16 items-center justify-between px-6 border-b border-gray-200 dark:border-gray-700 flex-shrink-0",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(B,{className:"h-8 w-8 text-primary-600"}),e.jsx("span",{className:"ml-2 text-xl font-bold text-gray-900 dark:text-white",children:"ESP32 Monitor"})]}),e.jsx("button",{onClick:()=>l(!1),className:"lg:hidden p-2 rounded-md text-gray-400 dark:text-gray-300 hover:text-gray-600 dark:hover:text-gray-100 transition-colors",children:e.jsx(ge,{className:"h-5 w-5"})})]}),e.jsx("nav",{className:"flex-1 px-4 py-6 space-y-2 overflow-y-auto dark:bg-gray-800",children:y.map(o=>{const u=o.icon,g=b(o.href);return e.jsxs(_,{to:o.href,className:`flex items-center px-4 py-3 text-sm font-medium rounded-lg transition-all duration-200 w-full ${g?"bg-primary-100 dark:bg-primary-900 text-primary-700 dark:text-primary-300 border-r-2 border-primary-600":"text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 hover:text-gray-900 dark:hover:text-white"}`,children:[e.jsx(u,{className:"w-5 h-5 mr-3 flex-shrink-0"}),e.jsx("span",{className:"truncate",children:o.name})]},o.name)})}),e.jsx("div",{className:"border-t border-gray-200 dark:border-gray-700 p-4 flex-shrink-0",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center min-w-0 flex-1",children:[e.jsx("div",{className:"h-8 w-8 rounded-full bg-primary-100 dark:bg-primary-900 flex items-center justify-center flex-shrink-0",children:e.jsx("span",{className:"text-sm font-medium text-primary-700 dark:text-primary-300",children:s==null?void 0:s.username.charAt(0).toUpperCase()})}),e.jsxs("div",{className:"ml-3 min-w-0 flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-gray-700 dark:text-gray-200 truncate",children:s==null?void 0:s.username}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Administrator"})]})]}),e.jsx("button",{onClick:a,className:"p-2 text-gray-400 dark:text-gray-300 hover:text-gray-600 dark:hover:text-gray-100 rounded-md transition-colors flex-shrink-0",title:"Logout",children:e.jsx(aa,{className:"w-4 h-4"})})]})})]})}),e.jsxs("div",{className:"flex-1 flex flex-col min-w-0 overflow-hidden",children:[e.jsx("div",{className:"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 px-4 sm:px-6 lg:px-8 flex-shrink-0",children:e.jsxs("div",{className:"flex h-16 items-center justify-between",children:[e.jsx("button",{id:"menu-button",onClick:()=>l(!0),className:"lg:hidden p-2 rounded-md text-gray-400 dark:text-gray-300 hover:text-gray-600 dark:hover:text-gray-100 transition-colors",children:e.jsx(ra,{className:"h-5 w-5"})}),e.jsxs("div",{className:"flex items-center space-x-4 ml-auto",children:[e.jsx(Pa,{}),e.jsxs(_,{to:"/devices/new",className:"btn btn-primary",children:[e.jsx(G,{className:"w-4 h-4 mr-2"}),"Add Device"]})]})]})}),e.jsx("main",{className:"flex-1 p-4 sm:p-6 lg:p-8 overflow-y-auto bg-gray-50 dark:bg-gray-900",children:e.jsx(C.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},className:"h-full",children:t})})]})]})}function Aa(){const{isAuthenticated:t}=ue();return t?e.jsx("div",{className:"h-screen flex flex-col overflow-hidden",children:e.jsx(Ia,{children:e.jsxs(et,{children:[e.jsx(q,{path:"/",element:e.jsx(pe,{to:"/dashboard",replace:!0})}),e.jsx(q,{path:"/dashboard",element:e.jsx(fa,{})}),e.jsx(q,{path:"/devices",element:e.jsx(De,{})}),e.jsx(q,{path:"/devices/new",element:e.jsx(De,{})}),e.jsx(q,{path:"/analytics",element:e.jsx(Ma,{})}),e.jsx(q,{path:"/reports/:deviceId",element:e.jsx(Ce,{})}),e.jsx(q,{path:"/reports",element:e.jsx(Ce,{})}),e.jsx(q,{path:"*",element:e.jsx(pe,{to:"/dashboard",replace:!0})})]})})}):e.jsx(xa,{})}const za=new tt({defaultOptions:{queries:{staleTime:1e3*60*5,refetchOnWindowFocus:!1}}}),La=()=>{const t=localStorage.getItem("theme-storage");if(t)try{const{state:s}=JSON.parse(t);s!=null&&s.isDarkMode&&document.documentElement.classList.add("dark")}catch{}};La();const Fa=st([{path:"*",element:e.jsx(Aa,{})}],{future:{v7_relativeSplatPath:!0}});ce.createRoot(document.getElementById("root")).render(e.jsx(Me.StrictMode,{children:e.jsx(at,{client:za,children:e.jsx(rt,{router:Fa})})}));
